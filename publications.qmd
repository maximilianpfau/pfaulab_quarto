---
title: "Publications"
page-layout: full
# Use any CSL you like (APA below prints DOI/URL by default).
# You can switch to Vancouver later with: csl: styles/vancouver.csl
csl: styles/apa.csl
bibliography: references.bib
link-citations: true
nocite: |
  @*   # render ALL items in publications.bib
---

<style>
/* two columns on wide screens, tidy spacing */
#refs { column-gap: 2rem; }
@media (min-width: 1100px) { #refs { column-count: 2; } }
.csl-entry { break-inside: avoid; margin: 0 0 .75rem 0; line-height: 1.45; }
.csl-entry a { text-decoration: none; }
.csl-entry a:hover { text-decoration: underline; }
/* emphasize title a bit (CSL typically italicizes titles with <i>…</i>) */
.csl-entry i { font-style: normal; font-weight: 600; }
.pub-year { margin: 2rem 0 .75rem; font-weight: 700; font-size: 1.1rem; }
</style>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const refs  = document.getElementById('refs');
  if (!refs) return;

  // 1) collect entries rendered by Pandoc/CSL
  const entries = Array.from(refs.querySelectorAll('.csl-entry'));

  // helper: extract a 4-digit year (prefers 20xx, then 19xx)
  function extractYear(str) {
    const m20 = str.match(/\b(20\d{2})\b/);
    const m19 = str.match(/\b(19\d{2})\b/);
    return m20 ? parseInt(m20[1],10) : (m19 ? parseInt(m19[1],10) : 0);
  }

  // 2) make titles clickable by wrapping the first <i>…</i> with the first DOI/URL link
  entries.forEach(el => {
    const titleEl = el.querySelector('i');               // CSL usually italicizes the title
    const firstLink = el.querySelector('a[href^="http"]'); // DOI or URL printed by CSL
    if (titleEl && firstLink && !titleEl.closest('a')) {
      const a = document.createElement('a');
      a.href = firstLink.href;
      a.target = '_blank';
      a.rel = 'noopener';
      titleEl.replaceWith(a);
      a.appendChild(titleEl);
    }
  });

  // 3) sort entries by year (DESC), fallback to original order for ties
  const enriched = entries.map((el, idx) => ({ el, y: extractYear(el.textContent), idx }))
                          .sort((a, b) => b.y - a.y || a.idx - b.idx);

  // 4) group with year headings
  refs.innerHTML = '';
  let current = null;
  enriched.forEach(({el, y}) => {
    if (y && y !== current) {
      current = y;
      const h = document.createElement('div');
      h.className = 'pub-year';
      h.textContent = y;
      refs.appendChild(h);
    }
    refs.appendChild(el);
  });
});
</script>
